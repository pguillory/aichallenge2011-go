package main

import "testing"

func TestSearchEngine(t *testing.T) {
    terrain := NewTerrain(
        "%%%%%%%%%\n" +
        "%a%...%b%\n" +
        "%.%.%.%.%\n" +
        "%...%...%\n" +
        "%%%%%%%%%")

    expected :=
    	"!!!!!!!!!\n" +
    	"!a!876!0!\n" +
    	"!a!9!5!1!\n" +
    	"!aaa!432!\n" +
    	"!!!!!!!!!"

    enemyAnts := new(PointSet)
    enemyAnts.Include(Point{1, 7})
    
    engine := NewSearchEngine(terrain)
    distances := engine.DistanceTo(enemyAnts)

    if distances.String() != expected {
        t.Error(distances)
    }
}

func TestSearchEngineStopsAtFriendlyAnts(t *testing.T) {
    terrain := NewTerrain(
        "%%%%%%%%%\n" +
        "%a%...%b%\n" +
        "%.%.a.%.%\n" +
        "%...%...%\n" +
        "%%%%%%%%%")

    expected :=
    	"!!!!!!!!!\n" +
    	"!a!876!0!\n" +
    	"!a!965!1!\n" +
    	"!aaa!432!\n" +
    	"!!!!!!!!!"

    enemyAnts := new(PointSet)
    enemyAnts.Include(Point{1, 7})
    
    engine := NewSearchEngine(terrain)
    distances := engine.DistanceTo(enemyAnts)

    if distances.String() != expected {
        t.Error(distances)
    }
}

func TestSearchSpeed(t *testing.T) {
    terrain := NewTerrain(
        "%%%...............................................................%%%...............................................................%%%...............................................................\n" +
        ".%%%...............................................................%%%...............................................................%%%..............................................................\n" +
        ".%%%...............................................................%%%...............................................................%%%..............................................................\n" +
        "..%%................................................................%%................................................................%%..............................................................\n" +
        "..%%.................%%...........%%.......%%%%...%%%...............%%.................%%...........%%.......%%%%...%%%...............%%.................%%...........%%.......%%%%...%%%.............\n" +
        "..%%................%%%..........%%%%%...%%%.%%%%%%%.......%........%%................%%%..........%%%%%...%%%.%%%%%%%.......%........%%................%%%..........%%%%%...%%%.%%%%%%%.......%......\n" +
        "...%........%%.....%%%..........%%.%%%%%%%%.....%%.........%%........%........%%.....%%%..........%%.%%%%%%%%.....%%.........%%........%........%%.....%%%..........%%.%%%%%%%%.....%%.........%%.....\n" +
        "...%%......%%.....%%%..........%%%....%%%..................%%........%%......%%.....%%%..........%%%....%%%..................%%........%%......%%.....%%%..........%%%....%%%..................%%.....\n" +
        "...%%.....%%.......%...........%%..........................%%........%%.....%%.......%...........%%..........................%%........%%.....%%.......%...........%%..........................%%.....\n" +
        "...%%....%%...................%%...........................%%........%%....%%...................%%...........................%%........%%....%%...................%%...........................%%.....\n" +
        ".%%%....%%....................%..................%.........%%......%%%....%%....................%..................%.........%%......%%%....%%....................%..................%.........%%.....\n" +
        "%%%.....%%....................%..................%................%%%.....%%....................%..................%................%%%.....%%....................%..................%................\n" +
        "%.......%%....................%..................................%%.......%%....................%..................................%%.......%%....................%..................................%\n" +
        ".........%%...................%%...........................................%%...................%%...........................................%%...................%%..................................\n" +
        ".........%%........%..........%%.......%%%%%...............................%%........%..........%%.......%%%%%...............................%%........%..........%%.......%%%%%......................\n" +
        ".........%%%.......%%%.......%%%.....%%%%.%%%..........%%..................%%%.......%%%.......%%%.....%%%%.%%%..........%%..................%%%.......%%%.......%%%.....%%%%.%%%..........%%.........\n" +
        "........%%%%%%......%%..............%%%................%%.................%%%%%%......%%..............%%%................%%.................%%%%%%......%%..............%%%................%%.........\n" +
        "......%%%...%%.........................................%%...............%%%...%%.........................................%%...............%%%...%%.........................................%%.........\n" +
        ".....%%%...............................................%%%%%%..........%%%...............................................%%%%%%..........%%%...............................................%%%%%%.....\n" +
        "%%.%%%.................................................%%%%%%%%%%%%%.%%%.................................................%%%%%%%%%%%%%.%%%.................................................%%%%%%%%%%%\n" +
        "%%%%%....................................1.............%%......%%%%%%%%....................................3.............%%......%%%%%%%%....................................5.............%%......%%%\n" +
        ".%%%%.........................................%%.......%%..........%%%%.........................................%%.......%%..........%%%%.........................................%%.......%%.........\n" +
        "...%%.........................................%%.......%%............%%.........................................%%.......%%............%%.........................................%%.......%%.........\n" +
        "....%%......................%%...............%%........%%.............%%......................%%...............%%........%%.............%%......................%%...............%%........%%.........\n" +
        ".....%%.......%%......%......................%%.........%..............%%.......%%......%......................%%.........%..............%%.......%%......%......................%%.........%.........\n" +
        "......%%.....%%%%%%%%%%..............%......%%..........%%..............%%.....%%%%%%%%%%..............%......%%..........%%..............%%.....%%%%%%%%%%..............%......%%..........%%........\n" +
        ".......%%.........%%%%%..........%%%%%%%....%%..........%%...............%%.........%%%%%..........%%%%%%%....%%..........%%...............%%.........%%%%%..........%%%%%%%....%%..........%%........\n" +
        ".......%%%.......................%%%%..%%...............%%...............%%%.......................%%%%..%%...............%%...............%%%.......................%%%%..%%...............%%........\n" +
        "........%%.............................%%...............%%....%%..........%%.............................%%...............%%....%%..........%%.............................%%...............%%....%%..\n" +
        ".........%.............................%%..............%%%%...%%%..........%.............................%%..............%%%%...%%%..........%.............................%%..............%%%%...%%%.\n" +
        "%.......%%.............................%%.........%%%%%%%%%.....%%%.......%%.............................%%.........%%%%%%%%%.....%%%.......%%.............................%%.........%%%%%%%%%.....%%\n" +
        "%%......%%%............................%%........%%%%%%..........%%%......%%%............................%%........%%%%%%..........%%%......%%%............................%%........%%%%%%..........%\n" +
        ".%%%.....%%%...........................%%..........................%%%.....%%%...........................%%..........................%%%.....%%%...........................%%.........................\n" +
        "..%%%.....%%%........%%%...............%%...........................%%%.....%%%........%%%...............%%...........................%%%.....%%%........%%%...............%%.........................\n" +
        "...%%......%%%%%%%%%%%%%%...%%.........%%............................%%......%%%%%%%%%%%%%%...%%.........%%............................%%......%%%%%%%%%%%%%%...%%.........%%.........................\n" +
        "............%%%%%%%%%%%%%...%%%........%%.....................................%%%%%%%%%%%%%...%%%........%%.....................................%%%%%%%%%%%%%...%%%........%%.........................\n" +
        "..............................%%.......%%.......................................................%%.......%%.......................................................%%.......%%.........................\n" +
        "...............................%%......%%........................................................%%......%%........................................................%%......%%.........................\n" +
        "................................%%.....%%%...%%%%.................................................%%.....%%%...%%%%.................................................%%.....%%%...%%%%.................\n" +
        ".........................................%%%%%%%%%.........................................................%%%%%%%%%.........................................................%%%%%%%%%................\n" +
        "%%........................................%%%...%%%%.......%%%%%%%%%........................................%%%...%%%%.......%%%%%%%%%........................................%%%...%%%%.......%%%%%%%\n" +
        "%%................................................%%%%...%%%%%%%%%%%................................................%%%%...%%%%%%%%%%%................................................%%%%...%%%%%%%%%\n" +
        ".%%..................%%.............................%%%%%%%........%%..................%%.............................%%%%%%%........%%..................%%.............................%%%%%%%.......\n" +
        "..%%%%%....%%%......%%%..............................%%%%...........%%%%%....%%%......%%%..............................%%%%...........%%%%%....%%%......%%%..............................%%%%.........\n" +
        "...%%%%%%%%%%.....%%%..................................%.............%%%%%%%%%%.....%%%..................................%.............%%%%%%%%%%.....%%%..................................%..........\n" +
        "........%%%.......%%.....................%................................%%%.......%%.....................%................................%%%.......%%.....................%........................\n" +
        "..................%%.........%%..........%..........................................%%.........%%..........%..........................................%%.........%%..........%........................\n" +
        "..................%%.........%%%.........%%.........................................%%.........%%%.........%%.........................................%%.........%%%.........%%.......................\n" +
        "...................%.........%%...........%..........................................%.........%%...........%..........................................%.........%%...........%.......................\n" +
        "...................%.........%%...........%%.........................................%.........%%...........%%.........................................%.........%%...........%%......................\n" +
        "...................%%........%%%......................%%%%...........................%%........%%%......................%%%%...........................%%........%%%......................%%%%........\n" +
        "%..................%%.........%%................%%....%%%%%%%%%%%%%..................%%.........%%................%%....%%%%%%%%%%%%%..................%%.........%%................%%....%%%%%%%%%%%%\n" +
        "%..................%%.........%%%...............%%%....%%%%%%%%%%%%..................%%.........%%%...............%%%....%%%%%%%%%%%%..................%%.........%%%...............%%%....%%%%%%%%%%%\n" +
        "%%.........%.......%%..........%%...............%%................%%.........%.......%%..........%%...............%%................%%.........%.......%%..........%%...............%%................\n" +
        ".%%.......%%%.......%%%.........%%.............%%%.................%%.......%%%.......%%%.........%%.............%%%.................%%.......%%%.......%%%.........%%.............%%%................\n" +
        ".%%.......%%.........%%.........%%%............%%..................%%.......%%.........%%.........%%%............%%..................%%.......%%.........%%.........%%%............%%.................\n" +
        "..%%%....%%..........%%..........%%%%%%........%%...................%%%....%%..........%%..........%%%%%%........%%...................%%%....%%..........%%..........%%%%%%........%%.................\n" +
        "...%%%%%%%............%.........%%%...%%......%%.....................%%%%%%%............%.........%%%...%%......%%.....................%%%%%%%............%.........%%%...%%......%%..................\n" +
        "......%...............%.........%%.....%%.....%%........%%..............%...............%.........%%.....%%.....%%........%%..............%...............%.........%%.....%%.....%%........%%........\n" +
        "...............................%%.......%%....%%........%%.......................................%%.......%%....%%........%%.......................................%%.......%%....%%........%%........\n" +
        "..............................%%%........%.....%%...............................................%%%........%.....%%...............................................%%%........%.....%%.................\n" +
        "..............................%%...............%%.............%%................................%%...............%%.............%%................................%%...............%%.............%%..\n" +
        ".............................%%%................%%............%................................%%%................%%............%................................%%%................%%............%...\n" +
        ".............................%%..................%%............................................%%..................%%............................................%%..................%%...............\n" +
        "................%................................%%%..............................%................................%%%..............................%................................%%%..............\n" +
        "...............%%%.....................%%.........%%%............................%%%.....................%%.........%%%............................%%%.....................%%.........%%%.............\n" +
        ".....%.......%%%%%%.................%%%%%%......%%%%...................%.......%%%%%%.................%%%%%%......%%%%...................%.......%%%%%%.................%%%%%%......%%%%..............\n" +
        "..%%%%......%%%%.%%%................%%...%%%...%%%..................%%%%......%%%%.%%%................%%...%%%...%%%..................%%%%......%%%%.%%%................%%...%%%...%%%................\n" +
        "%%%%......%%%%....%%%......................%%%%%................%%%%%%......%%%%....%%%......................%%%%%................%%%%%%......%%%%....%%%......................%%%%%................%%\n" +
        "%........%%%.......%%%......................%%%................%%%%........%%%.......%%%......................%%%................%%%%........%%%.......%%%......................%%%................%%%\n" +
        ".........%%.........%%%%%%%..................................%%%%..........%%.........%%%%%%%..................................%%%%..........%%.........%%%%%%%..................................%%%%.\n" +
        ".....................%%%.%%%.............................%%%%%%%%......................%%%.%%%.............................%%%%%%%%......................%%%.%%%.............................%%%%%%%%.\n" +
        ".....................%%....%%%..........................%%%%%..%%%.....................%%....%%%..........................%%%%%..%%%.....................%%....%%%..........................%%%%%..%%%\n" +
        "....................%%......%%%........................%%%%.....%%....................%%......%%%........................%%%%.....%%....................%%......%%%........................%%%%.....%%\n" +
        "%........%..........%%.......%%%%%%%%.................%%%........%%........%..........%%.......%%%%%%%%.................%%%........%%........%..........%%.......%%%%%%%%.................%%%........%\n" +
        "%%.......%%........%%..........%%%%%%%..............%%%...........%%.......%%........%%..........%%%%%%%..............%%%...........%%.......%%........%%..........%%%%%%%..............%%%...........\n" +
        ".%%......%%%.......%%................%%%..%%%%.....%%%.............%%......%%%.......%%................%%%..%%%%.....%%%.............%%......%%%.......%%................%%%..%%%%.....%%%............\n" +
        "..%.......%%.......%%.................%%%%%%%%%..%%%................%.......%%.......%%.................%%%%%%%%%..%%%................%.......%%.......%%.................%%%%%%%%%..%%%..............\n" +
        "....................%%..................%.....%%%%%...................................%%..................%.....%%%%%...................................%%..................%.....%%%%%...............\n" +
        "....................%%.........................%%%....................................%%.........................%%%....................................%%.........................%%%................\n" +
        "....................%%..........................%.....................................%%..........................%.....................................%%..........................%.................\n" +
        ".....................%%................................................................%%................................................................%%...........................................\n" +
        "%%................................................................%%................................................................%%................................................................\n" +
        "%%..........................%%....................................%%..........................%%....................................%%..........................%%....................................\n" +
        "............................%%................................................................%%................................................................%%....................................\n" +
        ".............................%%.............................%%.................................%%.............................%%.................................%%.............................%%....\n" +
        ".........%%...................%%...........................%%..............%%...................%%...........................%%..............%%...................%%...........................%%.....\n" +
        ".........%%...................%%..........................%%%..............%%...................%%..........................%%%..............%%...................%%..........................%%%.....\n" +
        "..........%%...................%%.........................%%................%%...................%%.........................%%................%%...................%%.........................%%......\n" +
        "..........%%%..................%%%.......................%%.................%%%..................%%%.......................%%.................%%%..................%%%.......................%%.......\n" +
        "..........%%%..................%%%.......................%%.................%%%..................%%%.......................%%.................%%%..................%%%.......................%%.......\n" +
        "..........%%...................%%.........................%%................%%...................%%.........................%%................%%...................%%.........................%%......\n" +
        ".........%%...................%%..........................%%%..............%%...................%%..........................%%%..............%%...................%%..........................%%%.....\n" +
        ".........%%...................%%...........................%%..............%%...................%%...........................%%..............%%...................%%...........................%%.....\n" +
        ".............................%%.............................%%.................................%%.............................%%.................................%%.............................%%....\n" +
        "............................%%................................................................%%................................................................%%....................................\n" +
        "%%..........................%%....................................%%..........................%%....................................%%..........................%%....................................\n" +
        "%%................................................................%%................................................................%%................................................................\n" +
        ".....................%%................................................................%%................................................................%%...........................................\n" +
        "....................%%..........................%.....................................%%..........................%.....................................%%..........................%.................\n" +
        "....................%%.........................%%%....................................%%.........................%%%....................................%%.........................%%%................\n" +
        "....................%%..................%.....%%%%%...................................%%..................%.....%%%%%...................................%%..................%.....%%%%%...............\n" +
        "..%.......%%.......%%.................%%%%%%%%%..%%%................%.......%%.......%%.................%%%%%%%%%..%%%................%.......%%.......%%.................%%%%%%%%%..%%%..............\n" +
        ".%%......%%%.......%%................%%%..%%%%.....%%%.............%%......%%%.......%%................%%%..%%%%.....%%%.............%%......%%%.......%%................%%%..%%%%.....%%%............\n" +
        "%%.......%%........%%..........%%%%%%%..............%%%...........%%.......%%........%%..........%%%%%%%..............%%%...........%%.......%%........%%..........%%%%%%%..............%%%...........\n" +
        "%........%..........%%.......%%%%%%%%.................%%%........%%........%..........%%.......%%%%%%%%.................%%%........%%........%..........%%.......%%%%%%%%.................%%%........%\n" +
        "....................%%......%%%........................%%%%.....%%....................%%......%%%........................%%%%.....%%....................%%......%%%........................%%%%.....%%\n" +
        ".....................%%....%%%..........................%%%%%..%%%.....................%%....%%%..........................%%%%%..%%%.....................%%....%%%..........................%%%%%..%%%\n" +
        ".....................%%%.%%%.............................%%%%%%%%......................%%%.%%%.............................%%%%%%%%......................%%%.%%%.............................%%%%%%%%.\n" +
        ".........%%.........%%%%%%%..................................%%%%..........%%.........%%%%%%%..................................%%%%..........%%.........%%%%%%%..................................%%%%.\n" +
        "%........%%%.......%%%......................%%%................%%%%........%%%.......%%%......................%%%................%%%%........%%%.......%%%......................%%%................%%%\n" +
        "%%%%......%%%%....%%%......................%%%%%................%%%%%%......%%%%....%%%......................%%%%%................%%%%%%......%%%%....%%%......................%%%%%................%%\n" +
        "..%%%%......%%%%.%%%................%%...%%%...%%%..................%%%%......%%%%.%%%................%%...%%%...%%%..................%%%%......%%%%.%%%................%%...%%%...%%%................\n" +
        ".....%.......%%%%%%.................%%%%%%......%%%%...................%.......%%%%%%.................%%%%%%......%%%%...................%.......%%%%%%.................%%%%%%......%%%%..............\n" +
        "...............%%%.....................%%.........%%%............................%%%.....................%%.........%%%............................%%%.....................%%.........%%%.............\n" +
        "................%................................%%%..............................%................................%%%..............................%................................%%%..............\n" +
        ".............................%%..................%%............................................%%..................%%............................................%%..................%%...............\n" +
        ".............................%%%................%%............%................................%%%................%%............%................................%%%................%%............%...\n" +
        "..............................%%...............%%.............%%................................%%...............%%.............%%................................%%...............%%.............%%..\n" +
        "..............................%%%........%.....%%...............................................%%%........%.....%%...............................................%%%........%.....%%.................\n" +
        "...............................%%.......%%....%%........%%.......................................%%.......%%....%%........%%.......................................%%.......%%....%%........%%........\n" +
        "......%...............%.........%%.....%%.....%%........%%..............%...............%.........%%.....%%.....%%........%%..............%...............%.........%%.....%%.....%%........%%........\n" +
        "...%%%%%%%............%.........%%%...%%......%%.....................%%%%%%%............%.........%%%...%%......%%.....................%%%%%%%............%.........%%%...%%......%%..................\n" +
        "..%%%....%%..........%%..........%%%%%%........%%...................%%%....%%..........%%..........%%%%%%........%%...................%%%....%%..........%%..........%%%%%%........%%.................\n" +
        ".%%.......%%.........%%.........%%%............%%..................%%.......%%.........%%.........%%%............%%..................%%.......%%.........%%.........%%%............%%.................\n" +
        ".%%.......%%%.......%%%.........%%.............%%%.................%%.......%%%.......%%%.........%%.............%%%.................%%.......%%%.......%%%.........%%.............%%%................\n" +
        "%%.........%.......%%..........%%...............%%................%%.........%.......%%..........%%...............%%................%%.........%.......%%..........%%...............%%................\n" +
        "%..................%%.........%%%...............%%%....%%%%%%%%%%%%..................%%.........%%%...............%%%....%%%%%%%%%%%%..................%%.........%%%...............%%%....%%%%%%%%%%%\n" +
        "%..................%%.........%%................%%....%%%%%%%%%%%%%..................%%.........%%................%%....%%%%%%%%%%%%%..................%%.........%%................%%....%%%%%%%%%%%%\n" +
        "...................%%........%%%......................%%%%...........................%%........%%%......................%%%%...........................%%........%%%......................%%%%........\n" +
        "...................%.........%%...........%%.........................................%.........%%...........%%.........................................%.........%%...........%%......................\n" +
        "...................%.........%%...........%..........................................%.........%%...........%..........................................%.........%%...........%.......................\n" +
        "..................%%.........%%%.........%%.........................................%%.........%%%.........%%.........................................%%.........%%%.........%%.......................\n" +
        "..................%%.........%%..........%..........................................%%.........%%..........%..........................................%%.........%%..........%........................\n" +
        "........%%%.......%%.....................%................................%%%.......%%.....................%................................%%%.......%%.....................%........................\n" +
        "...%%%%%%%%%%.....%%%..................................%.............%%%%%%%%%%.....%%%..................................%.............%%%%%%%%%%.....%%%..................................%..........\n" +
        "..%%%%%....%%%......%%%..............................%%%%...........%%%%%....%%%......%%%..............................%%%%...........%%%%%....%%%......%%%..............................%%%%.........\n" +
        ".%%..................%%.............................%%%%%%%........%%..................%%.............................%%%%%%%........%%..................%%.............................%%%%%%%.......\n" +
        "%%................................................%%%%...%%%%%%%%%%%................................................%%%%...%%%%%%%%%%%................................................%%%%...%%%%%%%%%\n" +
        "%%........................................%%%...%%%%.......%%%%%%%%%........................................%%%...%%%%.......%%%%%%%%%........................................%%%...%%%%.......%%%%%%%\n" +
        ".........................................%%%%%%%%%.........................................................%%%%%%%%%.........................................................%%%%%%%%%................\n" +
        "................................%%.....%%%...%%%%.................................................%%.....%%%...%%%%.................................................%%.....%%%...%%%%.................\n" +
        "...............................%%......%%........................................................%%......%%........................................................%%......%%.........................\n" +
        "..............................%%.......%%.......................................................%%.......%%.......................................................%%.......%%.........................\n" +
        "............%%%%%%%%%%%%%...%%%........%%.....................................%%%%%%%%%%%%%...%%%........%%.....................................%%%%%%%%%%%%%...%%%........%%.........................\n" +
        "...%%......%%%%%%%%%%%%%%...%%.........%%............................%%......%%%%%%%%%%%%%%...%%.........%%............................%%......%%%%%%%%%%%%%%...%%.........%%.........................\n" +
        "..%%%.....%%%........%%%...............%%...........................%%%.....%%%........%%%...............%%...........................%%%.....%%%........%%%...............%%.........................\n" +
        ".%%%.....%%%...........................%%..........................%%%.....%%%...........................%%..........................%%%.....%%%...........................%%.........................\n" +
        "%%......%%%............................%%........%%%%%%..........%%%......%%%............................%%........%%%%%%..........%%%......%%%............................%%........%%%%%%..........%\n" +
        "%.......%%.............................%%.........%%%%%%%%%.....%%%.......%%.............................%%.........%%%%%%%%%.....%%%.......%%.............................%%.........%%%%%%%%%.....%%\n" +
        ".........%.............................%%..............%%%%...%%%..........%.............................%%..............%%%%...%%%..........%.............................%%..............%%%%...%%%.\n" +
        "........%%.............................%%...............%%....%%..........%%.............................%%...............%%....%%..........%%.............................%%...............%%....%%..\n" +
        ".......%%%.......................%%%%..%%...............%%...............%%%.......................%%%%..%%...............%%...............%%%.......................%%%%..%%...............%%........\n" +
        ".......%%.........%%%%%..........%%%%%%%....%%..........%%...............%%.........%%%%%..........%%%%%%%....%%..........%%...............%%.........%%%%%..........%%%%%%%....%%..........%%........\n" +
        "......%%.....%%%%%%%%%%..............%......%%..........%%..............%%.....%%%%%%%%%%..............%......%%..........%%..............%%.....%%%%%%%%%%..............%......%%..........%%........\n" +
        ".....%%.......%%......%......................%%.........%..............%%.......%%......%......................%%.........%..............%%.......%%......%......................%%.........%.........\n" +
        "....%%......................%%...............%%........%%.............%%......................%%...............%%........%%.............%%......................%%...............%%........%%.........\n" +
        "...%%.........................................%%.......%%............%%.........................................%%.......%%............%%.........................................%%.......%%.........\n" +
        ".%%%%.........................................%%.......%%..........%%%%.........................................%%.......%%..........%%%%.........................................%%.......%%.........\n" +
        "%%%%%....................................0.............%%......%%%%%%%%....................................2.............%%......%%%%%%%%....................................4.............%%......%%%\n" +
        "%%.%%%.................................................%%%%%%%%%%%%%.%%%.................................................%%%%%%%%%%%%%.%%%.................................................%%%%%%%%%%%\n" +
        ".....%%%...............................................%%%%%%..........%%%...............................................%%%%%%..........%%%...............................................%%%%%%.....\n" +
        "......%%%...%%.........................................%%...............%%%...%%.........................................%%...............%%%...%%.........................................%%.........\n" +
        "........%%%%%%......%%..............%%%................%%.................%%%%%%......%%..............%%%................%%.................%%%%%%......%%..............%%%................%%.........\n" +
        ".........%%%.......%%%.......%%%.....%%%%.%%%..........%%..................%%%.......%%%.......%%%.....%%%%.%%%..........%%..................%%%.......%%%.......%%%.....%%%%.%%%..........%%.........\n" +
        ".........%%........%..........%%.......%%%%%...............................%%........%..........%%.......%%%%%...............................%%........%..........%%.......%%%%%......................\n" +
        ".........%%...................%%...........................................%%...................%%...........................................%%...................%%..................................\n" +
        "%.......%%....................%..................................%%.......%%....................%..................................%%.......%%....................%..................................%\n" +
        "%%%.....%%....................%..................%................%%%.....%%....................%..................%................%%%.....%%....................%..................%................\n" +
        ".%%%....%%....................%..................%.........%%......%%%....%%....................%..................%.........%%......%%%....%%....................%..................%.........%%.....\n" +
        "...%%....%%...................%%...........................%%........%%....%%...................%%...........................%%........%%....%%...................%%...........................%%.....\n" +
        "...%%.....%%.......%...........%%..........................%%........%%.....%%.......%...........%%..........................%%........%%.....%%.......%...........%%..........................%%.....\n" +
        "...%%......%%.....%%%..........%%%....%%%..................%%........%%......%%.....%%%..........%%%....%%%..................%%........%%......%%.....%%%..........%%%....%%%..................%%.....\n" +
        "...%........%%.....%%%..........%%.%%%%%%%%.....%%.........%%........%........%%.....%%%..........%%.%%%%%%%%.....%%.........%%........%........%%.....%%%..........%%.%%%%%%%%.....%%.........%%.....\n" +
        "..%%................%%%..........%%%%%...%%%.%%%%%%%.......%........%%................%%%..........%%%%%...%%%.%%%%%%%.......%........%%................%%%..........%%%%%...%%%.%%%%%%%.......%......\n" +
        "..%%.................%%...........%%.......%%%%...%%%...............%%.................%%...........%%.......%%%%...%%%...............%%.................%%...........%%.......%%%%...%%%.............\n" +
        "..%%................................................................%%................................................................%%..............................................................\n" +
        ".%%%...............................................................%%%...............................................................%%%..............................................................\n" +
        ".%%%...............................................................%%%...............................................................%%%..............................................................\n" +
        "%%%...............................................................%%%...............................................................%%%...............................................................")

    destinations := Where(func(p Point) bool {
        return terrain.At(p).HasEnemyHill()
    })
    
    engine := NewSearchEngine(terrain)
    engine.DistanceTo(destinations)

    start := now()
    for i := 0; i < 100; i++ {
        engine.DistanceTo(destinations)
    }
    time := now() - start

    //if time > 100 {
        t.Errorf("%v ms", time)
    //}
}
