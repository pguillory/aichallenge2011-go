package main

import "testing"

func TestForageMoves(t *testing.T) {
    terrain := NewTerrain(
        "%%%%%%%%%%%%%%%%%%%%%%%\n" +
        "%.....................%\n" +
        "%.*...*...............%\n" +
        "%.....................%\n" +
        "%.....A...............%\n" +
        "%....a................%\n" +
        "%.................*...%\n" +
        "%.....................%\n" +
        "%.....................%\n" +
        "%%%%%%%%%%%%%%%%%%%%%%%")
    expected :=
        ".......................\n" +
        ".......................\n" +
        ".......................\n" +
        ".......................\n" +
        "......N................\n" +
        ".....E.................\n" +
        ".......................\n" +
        ".......................\n" +
        ".......................\n" +
        "......................."

    moves := ForageMoves(terrain)

    if moves.String() != expected {
        t.Error(moves)
    }
}

func TestForageUsingFutureSpawns(t *testing.T) {
    terrain := NewTerrain(
        "%%%%%%%%%%%%%%%%%%%%%%%\n" +
        "%.....................%\n" +
        "%.*...*...............%\n" +
        "%.....................%\n" +
        "%.....A...............%\n" +
        "%...a.................%\n" +
        "%.................*...%\n" +
        "%.....................%\n" +
        "%.....................%\n" +
        "%%%%%%%%%%%%%%%%%%%%%%%")
    expected :=
        ".......................\n" +
        ".......................\n" +
        ".......................\n" +
        ".......................\n" +
        "......N................\n" +
        "....N..................\n" +
        ".......................\n" +
        ".......................\n" +
        ".......................\n" +
        "......................."

    moves := ForageMoves(terrain)

    if moves.String() != expected {
        t.Error(moves)
    }
}

func TestForageAroundObstacles(t *testing.T) {
    terrain := NewTerrain(
        "%%%%%%%%%%%%%%%%%%%%%%%%%\n" +
        "%.....%.................%\n" +
        "%.*%..%.a...............%\n" +
        "%%%%..%a%...............%\n" +
        "%.....%%................%\n" +
        "%.......................%\n" +
        "%.......................%\n" +
        "%.......................%\n" +
        "%.......................%\n" +
        "%%%%%%%%%%%%%%%%%%%%%%%%%")
    expected :=
        ".........................\n" +
        ".........................\n" +
        "........E................\n" +
        ".........................\n" +
        ".........................\n" +
        ".........................\n" +
        ".........................\n" +
        ".........................\n" +
        ".........................\n" +
        "........................."

    moves := ForageMoves(terrain)

    if moves.String() != expected {
        t.Error(moves)
    }
}
