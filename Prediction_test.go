package main

import "testing"
//import "fmt"

func TestPredictions(t *testing.T) {
    terrain1 := NewTerrain(
    "...................................................................%\n" +
    "...................................................................%\n" +
    "...................................................................%\n" +
    "...................................................................%\n" +
    "a....b.............................................................%\n" +
    "...................................................................%\n" +
    "...................................................................%\n" +
    "...................................................................%\n" +
    "...................................................................%\n" +
    "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%")
    terrain2 := NewTerrain(
    "...................................................................%\n" +
    "...................................................................%\n" +
    "...................................................................%\n" +
    "...................................................................%\n" +
    ".a..b..............................................................%\n" +
    "...................................................................%\n" +
    "...................................................................%\n" +
    "...................................................................%\n" +
    "...................................................................%\n" +
    "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%")

    p := Point{4, 4}
    expected := "NESWX, NESWX, E, E, E, "

    terrain := new(Terrain)
    predictions := NewPredictions(terrain)
    //t.Errorf("terrain.turn: %v, predictions.turn: %v\n", terrain.turn, predictions.turn)

    result := ""
    for turn = 1; turn <= 10; turn++ {
        terrain.Update(terrain1)
        predictions.Calculate()
        //t.Errorf("terrain.turn: %v, predictions.turn: %v\n", terrain.turn, predictions.turn)

        turn++
        terrain.Update(terrain2)
        predictions.Calculate()
        //t.Errorf("terrain.turn: %v, predictions.turn: %v\n", terrain.turn, predictions.turn)

        result += predictions.At(p).String() + ", "
    }

    if result != expected {
        t.Errorf("got: %v, expected: %v\n", result, expected)
    }
}
